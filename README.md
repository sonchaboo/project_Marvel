# project_Marvel

Мы собирали данные по членам организаций вселенной Марвел с помощью фреймворка scrapy. 
Брали с этого сайта: https://marvelcinematicuniverse.fandom.com/ru/wiki/%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D1%8F:%D0%9E%D1%80%D0%B3%D0%B0%D0%BD%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8.

Наш "паук" ходит по организациям, берет в них Основателей, Глав, Бывших руководителей, Членов и Бывших членов. Так же по каждому человеку в организации собирается какая-то информация (Пол, Гражданство, Также известен как и др. (будет пополняться еще)).

В **spider -> uni_spider.py** можно посмотреть код двух пауков (один собирает организации и людей, второй признаки для людей).

Файл **test1_formatrix.csv** содержит информацию, кто в какой организации существует (один человек может быть в несколкьих организациях).

Файл **res.csv** содержит данные по тому, как "знакомы" члены организаций и котоырй в дальнейшем используется для визуализации графа.
Логика построения "отношений" в организациях следующий:
у каждой организации были списки входящих или входивших в нее людей, т.е. основатель, глава, бывшие руководители, члены и бывшие члены. Мы считали, что люди связаны по следующим принципам: основатели связаны с главами и бывшими руководителями организаций, главы – с основателями, бывшими руководителями и членами, бывшие руководители – с основателями, главами и бывшими членами, члены – с главами и бывшими членами с вероятностью 1/2, бывшие члены – с бывшими руководителями и членами с вероятностью 1/2. Эти отношения применимы к членам одной организации, однако из-за того, что один и тот же человек может встречаться в разных ролях в разных организациях, граф получается связным. Кроме того, мы не допускали петель, удаляя возможные связи людей самих с собой, и не допускали кратных ребер, удаляя возможные дубликаты пар.

Код по составлению этих отношений прописан в **Сборка.ipynb**.

В файле **features.csv** хранятся данные по признакам людей. Сейчас это выглядит следующим образом: первый столбец - имя человека, второй - один из признаков, третий - значение этого признака. В дальнейшем это будет реализовано в виде таблицы объекты-признаки.

После подготовки всех данных мы загрузили файл **res.csv** в *neo4j* с помощью запроса:
```LOAD CSV WITH HEADERS FROM 'file:///C:/res.csv' AS line
MERGE (n:MyNode {Name:line.first})
MERGE (m:MyNode {Name:line.second})
MERGE (n) -[rel:KNOWS]-> (m)
```

И получили следующую визуализацию (прикладываем фрагмент):
![Иллюстрация к проекту](https://github.com/sonchaboo/project_Marvel/blob/master/%D0%90%D0%BD%D0%BD%D0%BE%D1%82%D0%B0%D1%86%D0%B8%D1%8F%202020-03-19%20224127.jpg)
